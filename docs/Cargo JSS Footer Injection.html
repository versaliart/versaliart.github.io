<script>
(function () {
  // tiny loader that appends to <head> (safer than body)
  function loadScript(src){
    return new Promise(function (resolve, reject) {
      var s = document.createElement('script');
      s.src = src;
      s.async = true;
      s.onload = function(){ resolve(src); };
      s.onerror = function(e){ reject(new Error('Failed to load ' + src)); };
      (document.head || document.documentElement).appendChild(s);
    });
  }

  // Always load Borderlines (rails) after DOM is parsed â€” no selector gate
  var domReady = (document.readyState !== 'loading')
    ? Promise.resolve()
    : new Promise(function(r){ document.addEventListener('DOMContentLoaded', r, {once:true}); });

  domReady
    .then(function(){ return loadScript('https://versaliart.github.io/Cargo%20JSS%20Borderlines.js'); })
    .then(function(){
      console.log('[Loader] Borderlines loaded');
      // prove the file executed (v1.37+ exposes this)
      console.log(window.MOTIF_RAILS && window.MOTIF_RAILS.ping ? window.MOTIF_RAILS.ping() : '[motif] ping missing');
    })
    .catch(function(err){ console.warn('[Loader] Borderlines failed', err); });

  // keep your other loaders as-is (just fix the duplicate log label below)
  function whenSelector(sel, cb){
    var el = document.querySelector(sel);
    if (el) return cb(el);
    var mo = new MutationObserver(function () {
      el = document.querySelector(sel);
      if (el) { mo.disconnect(); cb(el); }
    });
    mo.observe(document.documentElement, { childList: true, subtree: true });
  }

  whenSelector("#starfield-enable", function () {
    loadScript("https://versaliart.github.io/Cargo%20JSS%20Starfield.js")
      .then(()=>console.log("[Loader] Starfield loaded"))
      .catch(console.warn);
  });

  whenSelector(".tag-pills", function () {
    loadScript("https://versaliart.github.io/Cargo%20JSS%20Tags.js")
      .then(()=>console.log("[Loader] Tags loaded"))
      .catch(console.warn);
  });

  whenSelector('.sqs-block.image-block a[href="#flip-top"]', function () {
    loadScript("https://versaliart.github.io/Cargo%20JSS%20Topblock%20flip.js")
      .then(()=>console.log("[Loader] Topblock loaded"))
      .catch(console.warn);
  });

  whenSelector('header#header[data-test="header"]', function () {
    loadScript("https://versaliart.github.io/Cargo%20JSS%20Header.js")
      .then(()=>console.log("[Loader] Header loaded"))
      .catch(console.warn);
  });

// Snap-Scroll (loads only if a marker exists anywhere on the page)
whenSelector('[data-snap-scroll]', function () {
  loadScript('https://versaliart.github.io/JS%20Scroll.js')
    .then(() => console.log('[Loader] SnapScroll loaded'))
    .catch(err => console.warn('[Loader] SnapScroll failed', err)); 
});

  whenSelector(".card-table", function () {
    loadScript("https://versaliart.github.io/JS%20Cards.js")
      .then(()=>console.log("[Loader] TarotStack loaded"))
      .catch(console.warn);
  });

})();
</script>
