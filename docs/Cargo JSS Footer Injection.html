<!-- Footer Code Injection -->
<script>
(function () {
  // Wait until Squarespace has rendered at least one real section
  function whenSection(cb) {
    var sel = "section.page-section, section.sqs-section";
    var s = document.querySelector(sel);
    if (s) { cb(s); return; }
    var mo = new MutationObserver(function () {
      var s2 = document.querySelector(sel);
      if (s2) { mo.disconnect(); cb(s2); }
    });
    mo.observe(document.documentElement, { childList: true, subtree: true });
  }

  whenSection(function (section) {
    // Ensure global toggle + a marker INSIDE a section
    document.body.classList.add("has-starfield");
    var marker = document.getElementById("starfield-enable");
    if (!marker || !marker.closest("section.page-section, section.sqs-section")) {
      marker = document.createElement("div");
      marker.id = "starfield-enable";
      marker.hidden = true;
      marker.style.display = "none";
      var content = section.querySelector(":scope > .content-wrapper");
      if (content) section.insertBefore(marker, content);
      else section.prepend(marker);
    }

    // Now load the external file AFTER the marker exists
    var s = document.createElement("script");
    s.src = "https://versaliart.github.io/Cargo%20JSS%20Starfield.js?v=2025-09-02-1"; // cache-bust while testing
    s.async = false; // run in-order after this bootstrap
    s.onload = function(){ console.log("[Starfield] external file loaded"); };
    s.onerror = function(e){ console.warn("[Starfield] failed to load external file", e); };
    document.body.appendChild(s);
  });
})();
</script>
